# Weekly Market Report - 設計文件
# 建立日期: 2026-01-31

## 專案概述

### 目的
建立一套半自動化的週報系統，在每週一前產出台股與美股的交易/趨勢建議。

### 使用者需求
- **用途**: 個人交易參考 + 內容創作素材
- **交易風格**: 波段交易 (Swing) + 中長線投資
- **分析方法**: 基本面選股，技術面找進場點
- **自動化程度**: 半自動 (自動抓資料，人工判斷)
- **產出格式**: Notion 頁面 + 純文字/截圖 (社群用)
- **發布平台**: Threads, X (Twitter)

---

## 系統架構

```
┌─────────────────────────────────────────────────────────────┐
│                    週報產出流程                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌───────┐ │
│  │ 資料抓取 │ → │ 資料整理 │ → │ 人工判斷 │ → │ 產出  │ │
│  │ (自動)   │    │ (自動)   │    │ (你)     │    │ (半自)│ │
│  └──────────┘    └──────────┘    └──────────┘    └───────┘ │
│       │              │               │              │       │
│   週六/日早       週日中午前        週日下午       週日晚    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 技術堆疊
- **語言**: Python 3.11+
- **資料抓取**: Futu API, yfinance, BeautifulSoup/Playwright
- **資料儲存**: JSON, SQLite (optional)
- **發布**: Notion API, Threads API, X API v2, Playwright (備案)
- **排程**: macOS launchd / cron
- **AI 協作**: Claude Code Skills

---

## 報告內容區塊

### 1. 大盤趨勢總覽
- 美股三大指數 (S&P 500, NASDAQ, DJI)
- 台股加權指數 / 櫃買指數
- 技術指標: MA, RSI, MACD
- 趨勢判斷: 多/空/盤整

### 2. 板塊/產業輪動
- 美股 11 大板塊 ETF 表現
- 台股主要族群 (半導體、金融、傳產等)
- 資金流向分析

### 3. 個股觀察清單
- 符合篩選條件的標的
- 基本面數據摘要
- 技術面進場時機分析

### 4. 關鍵事件日曆
- 財報發布日
- FOMC 會議
- 期權到期日
- 其他重大事件

### 5. 交易計畫模板
- 本週擬操作標的
- 進場/停損/目標價位
- 風險控管

---

## 資料來源

| 來源 | 類型 | 用途 |
|------|------|------|
| 富途 Futu | API | 美股/港股即時報價、技術指標 |
| TradingView | 截圖 | 圖表截圖、視覺化分析 |
| Yahoo Finance | API (yfinance) | 美股歷史數據、基本面 |
| Goodinfo | 爬蟲 | 台股基本面、財報 |
| CMoney | 爬蟲 | 台股籌碼面 |
| Finviz | 爬蟲 | 美股篩選、熱力圖 |

---

## 發布機制

### 主要方式: API
- **Threads API**: Meta 官方 API
- **X API v2**: Twitter 官方 API (Free tier 1,500 篇/月)

### 備案方式: Playwright
- 當 API 額度不足或失效時
- 使用瀏覽器自動化模擬操作

### 發布流程
1. AI 產出社群版內容 (自動轉換格式)
2. 預覽 Threads 版 + X 串推版
3. 使用者確認
4. 自動發布 (API 優先，失敗則用 Playwright)

---

## Claude Code Skills

### `/market-data-fetch`
```yaml
觸發時機: 週六晚 / 週日早 (手動或排程)
功能:
  - 執行 scripts/fetch_all.py
  - 抓取所有資料源
  - 儲存至 data/raw/
  - 回報抓取狀態與錯誤
輸出: data/raw/{date}/*.json
```

### `/weekly-report`
```yaml
觸發時機: 週日下午 (手動)
功能:
  - 讀取 data/ 最新資料
  - 逐區塊產出分析內容
  - 每區塊與使用者確認/討論
  - 產出 Notion 週報頁面
  - 產出社群版 (Threads + X)
  - 使用者確認後發布
輸出:
  - Notion 頁面
  - data/processed/{date}/report.md
  - data/processed/{date}/threads.md
  - data/processed/{date}/x_thread.md
```

### `/trade-plan`
```yaml
觸發時機: 需要時 (手動)
功能:
  - 基於當週觀察清單
  - 協助設定進出場價位
  - 計算風險報酬比
  - 輸出交易計畫表
輸出: 交易計畫 Markdown / Notion
```

---

## 執行時間表

| 時間 | 動作 | 方式 |
|------|------|------|
| 週六 22:00 | 資料抓取 | 自動排程 / 手動觸發 |
| 週日 10:00 | 資料確認 | 檢查抓取是否成功 |
| 週日 14:00 | 週報撰寫 | `/weekly-report` |
| 週日 18:00 | 社群發布 | 確認後自動發布 |

---

## 後續擴展 (Optional)

- [ ] 增加 Discord/Telegram 通知
- [ ] 增加語音版週報 (TTS)
- [ ] 增加歷史績效追蹤
- [ ] 增加 AI 選股建議
- [ ] 增加回測功能整合

---

## 變更記錄

| 日期 | 變更內容 |
|------|----------|
| 2026-01-31 | 初版設計完成 |
